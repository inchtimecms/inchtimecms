{% extends 'admin_pages/base.html.twig' %}

{% block title %}编辑内容 {{ contentEntity.title }}{% endblock %}

{% block subHeader %}
    <div class="m-subheader ">
        <div class="d-flex align-items-center">
            <div class="mr-auto">
                <h3 class="m-subheader__title ">编辑内容 {{ contentEntity.title }}</h3>
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}

    <div class="col-md-12">
        <!--begin::Portlet-->
        <div class="m-portlet m-portlet--tab">
            <!--begin::Form-->
            <form class="m-form m-form--fit m-form--label-align-right" method="post" id="addNewContent"
                  action={{ path("content_entity_edit_action",{"contentEntity_id": contentEntity.id }) }}>
                <div class="m-portlet__body">
                    <div class="fields_wrapper">
                        <div class="form-group m-form__group">
                            <div class="m--margin-top-10">
                                <label class="font-weight-bold">标题（必填）：</label>
                                <input type="text" class="form-control m-input" required="required" name="contentTitle"
                                       value="{{ contentEntity.title }}">
                            </div>
                            <div class="m--margin-top-10">
                                <label class="font-weight-bold">正文：</label>
                                <textarea id="summernote" class="form-control m-input" rows="3" required="required"
                                          name="contentBody">{{ contentEntity.body }}</textarea>
                            </div>

                            {#循环显示当前内容类型下的字段的input#}
                            {% for fieldTypeEntity in fieldTypeEntitys %}
                                {% if fieldTypeEntity.deleted != "1" %}
                                    <div class="m--margin-top-10">
                                        <label class="font-weight-bold">{{ fieldTypeEntity.fieldName }}:</label><i
                                                class="m--margin-left-20 m-loader" style="display: none;"></i>
                                        {% if fieldTypeEntity.fieldTypeValue.fieldTypeInSQL == "string"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "图像"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "文件"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "内容"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "小数"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "布尔值"
                                        and fieldTypeEntity.fieldTypeValue.fieldValueTypeName != "分类标签" %}

                                            <input type="text" class="form-control m-input"
                                                   name="string:{{ fieldTypeEntity.fieldMachineAlias }}"
                                                   value="{% for fieldTableEntity in contentEntity.fieldTableEntitys %}{% if fieldTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                   and fieldTableEntity.deleted != "1" %}{{ fieldTableEntity.fieldTableValue }}{% endif %}{% endfor %}">

                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}</span>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "日期" %}

                                            <input type="datetime-local" class="form-control m-input"
                                                   style="width: 50%;"
                                                   name="datetime:{{ fieldTypeEntity.fieldMachineAlias }}"
                                                   value="{% for fieldTableEntity in contentEntity.fieldTableEntitys %}{% if fieldTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                   and fieldTableEntity.deleted != "1" %}{{ fieldTableEntity.fieldTableValue }}{% endif %}{% endfor %}">

                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}</span>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "长纯文本" %}
                                            <textarea class="form-control m-input" rows="3"
                                                      name="text:{{ fieldTypeEntity.fieldMachineAlias }}">{% for fieldTextTableEntity in contentEntity.fieldTextTableEntitys %}{% if fieldTextTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                and fieldTextTableEntity.deleted != "1" %}{{ fieldTextTableEntity.fieldTableValue }}{% endif %}{% endfor %}</textarea>

                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}</span>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "内容" %}

                                            <input type="text" class="form-control m-input field_ref_contentType"
                                                   content="{{ fieldTypeEntity.fieldSettings }}"
                                                   oninput='fetchContentTypeEntityList("{{ path('fetch_content_action') }}",this);'
                                                   name="string:{{ fieldTypeEntity.fieldMachineAlias }}">


                                            <div class="input-choice-wrapper" style="display:none;">
                                                <ul>
                                                </ul>
                                            </div>
                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}</span>
                                            <div class="refContentList" style="">
                                                <ul>
                                                    {% for fieldContentTableEntity in contentEntity.fieldContentTableEntitys %}
                                                        {% if fieldContentTableEntity.fieldAlias == fieldTypeEntity.fieldMachineAlias %}
                                                            <li class="ref-li">
                                                                <i class="flaticon-close"
                                                                   onclick="removeThisRef(this,'ref_content',{{ fieldContentTableEntity.id }});"></i>
                                                                <span id="{{ fieldContentTableEntity.refContentEntity.id }}"
                                                                      class="ref-item">{{ fieldContentTableEntity.refContentEntity.title }}</span>
                                                            </li>
                                                        {% endif %}
                                                    {% endfor %}
                                                </ul>
                                            </div>

                                            <input type="hidden" class="form-control m-input field_ref_contentType"
                                                   name="ref_contentType:{{ fieldTypeEntity.fieldMachineAlias }}"
                                                   value="{% for fieldContentTableEntity in contentEntity.fieldContentTableEntitys %}{% if fieldContentTableEntity.fieldAlias == fieldTypeEntity.fieldMachineAlias %}{{ fieldContentTableEntity.refContentEntity.id }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}">

                                            <div class="clearfix"></div>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "分类标签" %}

                                            <input type="text" class="form-control m-input field_ref_taxonomyType "
                                                   content="{{ fieldTypeEntity.fieldSettings }}"
                                                   oninput='fetchTaxonomyEntityList("{{ path('fetch_taxonomy_action') }}", this);'
                                                   name="string:{{ fieldTypeEntity.fieldMachineAlias }}">

                                            <div class="input-choice-wrapper" style="display:none;">
                                                <ul>
                                                </ul>
                                            </div>
                                            <button type="button" onclick="addTaxonomyBtnClick(this)"
                                                    class="btn btn-primary btn-sm addTaxonomyEntity m--margin-top-10 m--margin-bottom-10">
                                                添加词汇
                                            </button>
                                            <span class="m-form__help"
                                                  class="d-block">{{ fieldTypeEntity.fieldDescription }}
                                                填写好分类词汇后，点击添加词汇按钮，多个词汇之间请用空格符分开。</span>
                                            <div class="refContentList" style="">
                                                <ul>
                                                    {% for fieldTaxonomyTableEntity in contentEntity.fieldTaxonomyTableEntitys %}

                                                        {% if fieldTaxonomyTableEntity.fieldAlias == fieldTypeEntity.fieldMachineAlias %}
                                                            <li class="ref-li">
                                                                <i class="flaticon-close"
                                                                   onclick="removeThisRef(this,'ref_taxonomy',{{ fieldTaxonomyTableEntity.id }});"></i>
                                                                <span id="{{ fieldTaxonomyTableEntity.taxonomyEntity.id }}"
                                                                      class="ref-item">{{ fieldTaxonomyTableEntity.taxonomyEntity.taxonomyWord }}</span>
                                                            </li>
                                                        {% endif %}
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            <input type="hidden" class="form-control m-input field_ref_taxonomyType"
                                                   name="ref_taxonomyType:{{ fieldTypeEntity.fieldMachineAlias }}"
                                                   value="{% for fieldTaxonomyTableEntity in contentEntity.fieldTaxonomyTableEntitys %}{% if fieldTaxonomyTableEntity.fieldAlias == fieldTypeEntity.fieldMachineAlias %}{{ fieldTaxonomyTableEntity.taxonomyEntity.id }}{% if loop.last == false %},{% endif %}{% endif %}{% endfor %}">

                                            <div class="clearfix"></div>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "文件" %}

                                            {% set fileExtensions = fieldTypeEntity.fieldSettings | split(" ") %}

                                            <input type="file" class="form-control m-input"
                                                    {% for fieldFileTableEntity in contentEntity.fieldFileTableEntitys %}{% if fieldFileTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                    and fieldFileTableEntity.deleted != "1" %} style="display:none;" {% endif %}{% endfor %}
                                                   content="upload-file"
                                                   onchange='fileInputClick("{{ path('file_upload') }}", this)'
                                                   accept="{% for fileExtension in fileExtensions %}{{ value[fileExtension] }},{% endfor %}"
                                                   name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}">
                                            <label>{{ fieldTypeEntity.fieldDescription }}
                                                允许的文件后缀：{{ fieldTypeEntity.fieldSettings }}</label>

                                            {% if contentEntity.fieldFileTableEntitys | length > 0 %}
                                                {% for fieldFileTableEntity in contentEntity.fieldFileTableEntitys %}
                                                    {% if fieldFileTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                    and fieldFileTableEntity.deleted != "1" %}
                                                        <div class="uploaded-file">
                                                            <span><i class="flaticon-book"></i></span>
                                                            <a target="_blank"
                                                               href=" {{ asset(fieldFileTableEntity.fileManagedEntity.uri) }} "> {{ fieldFileTableEntity.fileManagedEntity.fileName }} </a>
                                                            <input type="hidden" class="m-input" required="required"
                                                                   name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}:{{ fieldFileTableEntity.fileManagedEntity.id }} ">
                                                            <button type="button"
                                                                    id="{{ fieldFileTableEntity.fileManagedEntity.id }}"
                                                                    onclick="deleteUploadFile(this);"
                                                                    class="m--margin-left-20 btn btn-secondary btn-sm deleteUploadFile">
                                                                删除
                                                            </button>
                                                        </div>

                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "图像" %}

                                            {% set fileExtensions = fieldTypeEntity.fieldSettings | split(" ") %}

                                            <input type="file" class="form-control m-input"
                                                    {% for fieldImageTableEntity in contentEntity.fieldImageTableEntitys %}
                                                        {% if fieldImageTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                        and fieldImageTableEntity.deleted != 1 %}
                                                            style="display:none;"
                                                        {% endif %}
                                                    {% endfor %}
                                                   content="upload-image"
                                                   onchange='fileInputClick("{{ path('file_upload') }}", this)'
                                                   accept="{% for fileExtension in fileExtensions %}{{ value[fileExtension] }},{% endfor %}"
                                                   name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}">
                                            <label>{{ fieldTypeEntity.fieldDescription }}
                                                允许的图像后缀：{{ fieldTypeEntity.fieldSettings }}</label>

                                            {% if contentEntity.fieldImageTableEntitys | length > 0 %}
                                                {% for fieldImageTableEntity in contentEntity.fieldImageTableEntitys %}
                                                    {% if fieldImageTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                    and fieldImageTableEntity.deleted != "1" %}
                                                        <div class="row uploaded-img">
                                                            <div class="col-4">
                                                                <img src="{{ asset(fieldImageTableEntity.fileManagedEntity.uri) | imagine_filter('fileManager_thumbnail') }}">
                                                            </div>
                                                            <div class="col-8">
                                                                <label>输入图片的机读文本:(必填)</label>
                                                                <input class="form-control m-input" type="text"
                                                                       required="required"
                                                                       value="{{ fieldImageTableEntity.imageAlt }}"
                                                                       name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}:{{ fieldImageTableEntity.fileManagedEntity.id }}:imgAlt">
                                                                <button type="button"
                                                                        id="{{ fieldImageTableEntity.fileManagedEntity.id }}"
                                                                        onclick="deleteUploadImage(this);"
                                                                        class="m--margin-top-10 btn btn-secondary btn-sm deleteUploadImage">
                                                                    删除
                                                                </button>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "小数" %}
                                            {# 如果当前字段的别名和商品类型的引用的别名相同 #}

                                            <input type="text" class="form-control m-input"
                                                   onkeyup="value=value.replace(/[^\d{1,}\.\d{1,}|\d{1,}]/g,'')"
                                                   onblur="toDecimal2(this, {{ fieldTypeEntity.fieldSettings }})"
                                                   value="{% for fieldTableEntity in contentEntity.fieldTableEntitys %}{% if fieldTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                   and fieldTableEntity.deleted != "1" %}{{ fieldTableEntity.fieldTableValue }}{% endif %}{% endfor %}"
                                                    {% if contentTypeEntity.productTypeEntity != null %}
                                                        {% if contentTypeEntity.productTypeEntity.priceField == fieldTypeEntity.fieldMachineAlias %}required="required"{% endif %}
                                                        {% if contentTypeEntity.productTypeEntity.discountPriceField == fieldTypeEntity.fieldMachineAlias %}required="required"{% endif %}
                                                    {% endif %}
                                                   name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}">
                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}
                                                ,请输入小数,且小数点后保留：{{ fieldTypeEntity.fieldSettings }}位.</span>

                                        {% elseif fieldTypeEntity.fieldTypeValue.fieldValueTypeName == "布尔值" %}

                                            {# 如果当前字段的别名和商品类型的引用的别名相同 #}
                                            {% set saleStatus = fieldTypeEntity.fieldSettings|split(",") %}
                                            <label class="m-radio m--margin-left-20">
                                                <input type="radio" value="1"
                                                       {% for fieldTableEntity in contentEntity.fieldTableEntitys %}{% if fieldTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                       and fieldTableEntity.deleted != "1" %}{% if fieldTableEntity.fieldTableValue == "1" %}checked="checked"{% endif %}{% endif %}{% endfor %}
                                                        {% if contentTypeEntity.productTypeEntity != null %}
                                                            {% if contentTypeEntity.productTypeEntity.saleStatus == fieldTypeEntity.fieldMachineAlias %}required="required"{% endif %}
                                                        {% endif %}
                                                       name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}">{{ saleStatus[0] }}
                                                <span></span>
                                            </label>
                                            <label class="m-radio m--margin-left-20">
                                                <input type="radio" value="0"
                                                       {% for fieldTableEntity in contentEntity.fieldTableEntitys %}{% if fieldTableEntity.fieldAliasInContentTypeEntity == fieldTypeEntity.fieldMachineAlias
                                                       and fieldTableEntity.deleted != "1" %}{% if fieldTableEntity.fieldTableValue == "0" %}checked="checked"{% endif %}{% endif %}{% endfor %}
                                                        {% if contentTypeEntity.productTypeEntity != null %}
                                                            {% if contentTypeEntity.productTypeEntity.saleStatus == fieldTypeEntity.fieldMachineAlias %}required="required"{% endif %}
                                                        {% endif %}
                                                       name="{{ fieldTypeEntity.id }}:{{ fieldTypeEntity.fieldMachineAlias }}">{{ saleStatus[1] }}
                                                <span></span>
                                            </label>
                                            <br>
                                            <span class="m-form__help">{{ fieldTypeEntity.fieldDescription }}</span>
                                        {% endif %}


                                    </div>
                                {% endif %}

                            {% endfor %}

                            {#如果当前内容类型有对应的商品类型，这里开始添加的是商品类型的字段,比如销售属性等#}
                            {% if contentTypeEntity.productTypeEntity != null %}
                                <div class="m--margin-top-10">
                                    <label class="font-weight-bold">勾选销售属性：</label>
                                    {#//获取商品的销售属性#}
                                    {% for salePropGroup in contentTypeEntity.productTypeEntity.salePropField %}
                                        {% if loop.index == 1 %}
                                            <div class="sale-prop-group-1 m--margin-bottom-20">
                                                <label for="">{{ salePropGroup.title }}</label>
                                                {% for key, group1Item in contentEntity.fieldProductPropsTableEntity.group1PropsJson.prop %}
                                                    {#{{ dump(key) }} {{ dump(group1Item) }}#}
                                                    <div class="sale-prop-group-1-item m--margin-top-10 col-12">
                                                        <div class="row">
                                                            <div class="col-1 m-checkbox-inline">
                                                                <label class="m-checkbox">
                                                                    <input type="checkbox" value="{{ group1Item.name }}"
                                                                           onclick="propCheckBoxClick(this)"
                                                                           checked="checked"
                                                                           class="sale-prop-group-1-item-checkbox">
                                                                    <span></span>
                                                                </label>
                                                            </div>
                                                            <div class="col-4">
                                                                <input class="form-control m-input sale-prop-group-1-item-value"
                                                                       value="{{ group1Item.name }}" readonly="readonly"
                                                                       placeholder="请选择{{ salePropGroup.title }}"
                                                                       name="group1[prop][{{ key }}][name]"
                                                                       type="text">
                                                                <div class="list-group" style="display: none;">
                                                                    {% for salePropValKey, salePropValValue in salePropGroup.value %}
                                                                        <a class="list-group-item list-group-item-action"
                                                                           onclick="propValueLiClick(this)">{{ salePropValValue }}</a>
                                                                    {% endfor %}
                                                                </div>
                                                            </div>
                                                            <div class="col-4">
                                                                <input class="form-control m-input sale-prop-group-1-item-commit"
                                                                       name="group1[prop][{{ key }}][commit]"
                                                                       value="{{ group1Item.commit }}"
                                                                       placeholder="属性备注" type="text">
                                                            </div>
                                                            <div class="col-3">
                                                                <input type="hidden"
                                                                       class="upload-large-img-result-input"
                                                                       name="group1[prop][{{ key }}][largeimage]"
                                                                       value="{{ group1Item.largeimage }}">
                                                                <input type="hidden"
                                                                       class="upload-small-img-result-input"
                                                                       name="group1[prop][{{ key }}][smallimage]"
                                                                       value="{{ group1Item.smallimage }}">
                                                                <input type="hidden" class="upload-img-entity-id"
                                                                       name="group1[prop][{{ key }}][imgfileId]"
                                                                       value="{{ group1Item.imgfileId }}">
                                                                <input type="file"
                                                                       onchange='uploadPropsImg("{{ path('file_upload') }}",this)'
                                                                       style="display:none"
                                                                       class="upload-file-hidden-input"
                                                                       accept="image/gif,image/jpeg,image/png">

                                                                <button class="upload-img-btn btn btn-secondary"
                                                                        {% if group1Item.largeimage != "" %}style="display: none;"{% endif %}
                                                                        onclick="btnPropsImgClick(this)" type="button">
                                                                    上传图片
                                                                </button>
                                                                <div class="prop-img-result"
                                                                     {% if group1Item.largeimage == "" %}style="display: none;"{% endif %}>
                                                                    <img width="40px" height="40px"
                                                                         src="{{ group1Item.smallimage }}">
                                                                    <button class="btn btn-secondary" type="button"
                                                                            data-uploadimgid="{{ group1Item.imgfileId }}"
                                                                            onclick="deletePropsImg(this)">删除图片
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                                <div class="sale-prop-group-1-item m--margin-top-10 col-12">
                                                    <div class="row">
                                                        <div class="col-1 m-checkbox-inline">
                                                            <label class="m-checkbox" style="display: none;">
                                                                <input type="checkbox" onclick="propCheckBoxClick(this)"
                                                                       class="sale-prop-group-1-item-checkbox">
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                        <div class="col-4">
                                                            <input class="form-control m-input sale-prop-group-1-item-value"
                                                                   value="" readonly="readonly"
                                                                   onclick="propValueClick(this)"
                                                                   placeholder="请选择{{ salePropGroup.title }}"
                                                                   type="text">
                                                            <div class="list-group" style="display: none;">
                                                                {% for salePropValKey, salePropValValue in salePropGroup.value %}
                                                                    <a class="list-group-item list-group-item-action"
                                                                       onclick="propValueLiClick(this)">{{ salePropValValue }}</a>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                        <div class="col-4">
                                                            <input class="form-control m-input sale-prop-group-1-item-commit"
                                                                   value="" placeholder="属性备注" type="text">
                                                        </div>
                                                        <div class="col-3">
                                                            <input type="hidden" class="upload-large-img-result-input">
                                                            <input type="hidden" class="upload-small-img-result-input">
                                                            <input type="hidden" class="upload-img-entity-id">
                                                            <input type="file"
                                                                   onchange='uploadPropsImg("{{ path('file_upload') }}",this)'
                                                                   style="display:none" class="upload-file-hidden-input"
                                                                   accept="image/gif,image/jpeg,image/png">
                                                            <button class="upload-img-btn btn btn-secondary"
                                                                    onclick="btnPropsImgClick(this)" type="button">上传图片
                                                            </button>
                                                            <div class="prop-img-result" style="display: none;">
                                                                <img width="40px" height="40px">
                                                                <button class="btn btn-secondary" type="button"
                                                                        onclick="deletePropsImg(this)">删除图片
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% else %}
                                            <div class="sale-prop-group-2">
                                                <label for="">{{ salePropGroup.title }}</label>
                                                <div class="m-checkbox-inline">
                                                    {% for salePropValKey, salePropValValue in salePropGroup.value %}
                                                        <label class="m-checkbox">
                                                            <input type="checkbox" class="sale-prop-group-2-checkbox"
                                                                   name="group2[prop][{{ loop.index0 }}][name]"
                                                                    {% for key, group2Item in contentEntity.fieldProductPropsTableEntity.group2PropsJson.prop %}
                                                                        {#{{ dump(key) }} {{ dump(group2Item) }}#}
                                                                        {% if  group2Item.name == salePropValValue %}checked="checked"{% endif %}
                                                                    {% endfor %}
                                                                   onclick="group2checkboxClick(this)"
                                                                   value="{{ salePropValValue }}"> {{ salePropValValue }}
                                                            <span></span>
                                                        </label>

                                                    {% endfor %}
                                                </div>
                                                <span class="m-form__help">请勾选此商品对应的销售属性</span>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>

                                <div class="m--margin-top-10">
                                    <label class="font-weight-bold">销售规格：</label>
                                    {#//动态增加商品的销售属性#}
                                    <div class="sale-props-table">
                                        <table class="col-12 table">
                                            <thead>
                                            <tr>
                                                {% for salePropGroup in contentTypeEntity.productTypeEntity.salePropField %}
                                                    <th>{{ salePropGroup.title }}</th>
                                                {% endfor %}
                                                <th>库存</th>
                                                <th>单价</th>
                                                <th>商品编码</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                {% for salePropGroup in contentTypeEntity.productTypeEntity.salePropField %}
                                                    <td></td>
                                                {% endfor %}
                                                <td>
                                                    <div class="form-inline input-group-sm">
                                                        <input class="form-control md-input bat-modify-number col-6"
                                                               type="number" min="0">
                                                        <button type="button" class="btn btn-sm btn-bat-modify-number"
                                                                onclick="batBtnClick('.bat-modify-number','.sale-prop-row-number')">
                                                            批量修改
                                                        </button>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="form-inline input-group-sm">
                                                        <input class="form-control md-input bat-modify-price col-6"
                                                               type="text" onblur="toDecimal2(this, 2)"
                                                               onkeyup="value=value.replace(/[^\d{1,}\.\d{1,}|\d{1,}]/g,'')">
                                                        <button type="button" class="btn btn-sm  btn-bat-modify-price"
                                                                onclick="batBtnClick('.bat-modify-price','.sale-prop-row-price')">
                                                            批量修改
                                                        </button>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="form-inline input-group-sm">
                                                        <input class="form-control md-input bat-modify-code col-6"
                                                               type="text" onkeyup="value=value.replace(/[\W]/g,'')">
                                                        <button type="button" class="btn btn-sm  btn-bat-modify-code"
                                                                onclick="batBtnClick('.bat-modify-code','.sale-prop-row-code')">
                                                            批量修改
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                                {% for key,salePropsItem in contentEntity.fieldProductPropsTableEntity.fieldProductPropsValue %}
                                                    {#{{ dump(key) }}#}
                                                    {#{{ dump(salePropsItem) }}#}
                                                    <tr class="sale-prop-row">
                                                        <td><input class="form-control m-input" name="sale-prop[{{ key }}][group1][name]" type="text" value="{{ salePropsItem.group1.name }}" readonly="readonly" ></td>
                                                        {% if salePropsItem.group2 is defined %}
                                                        <td><input class="form-control m-input" name="sale-prop[{{ key }}][group2][name]" type="text" value="{{ salePropsItem.group2.name }}" readonly="readonly" ></td>
                                                        {% endif %}
                                                        <td><input class="form-control m-input sale-prop-row-number"
                                                                    {% if salePropsItem.group2 is defined %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}:{{ salePropsItem.group2.name}}][number]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name~':'~salePropsItem.group2.name].number }}"
                                                                    {% else %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}][number]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name].number }}"
                                                                    {% endif %}
                                                                   type="number" min="0" ></td>
                                                        <td><input class="form-control m-input sale-prop-row-price"
                                                                    {% if salePropsItem.group2 is defined %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}:{{ salePropsItem.group2.name}}][price]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name~':'~salePropsItem.group2.name].price }}"
                                                                    {% else %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}][price]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name].price }}"
                                                                    {% endif %}
                                                                   onkeyup="value=value.replace(/[^\d{1,}\.\d{1,}|\d{1,}]/g,'')" onblur="toDecimal2(this, 2)" type="text"></td>
                                                        <td><input class="form-control m-input sale-prop-row-code"
                                                                    {% if salePropsItem.group2 is defined %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}:{{ salePropsItem.group2.name}}][code]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name~':'~salePropsItem.group2.name].code }}"
                                                                    {% else %}
                                                                        name="sale-prop[{{ key }}][{{ salePropsItem.group1.name}}][code]"
                                                                        value="{{ salePropsItem[salePropsItem.group1.name].code }}"
                                                                    {% endif %}
                                                                   type="text" onkeyup="value=value.replace(/[\W]/g,'')" ></td>
                                                    </tr>
                                                {% endfor %}
                                            </tbody>

                                        </table>
                                    </div>
                                </div>

                            {% endif %}


                        </div>
                    </div>

                </div>
                <div class="m-portlet__foot m-portlet__foot--fit">
                    <div class="m-form__actions">
                        <input type="hidden" name="_csrf_token" value="{{ csrf_token("edit_content_entity") }}">
                        <button id="editNewContentTypeButton" class="btn btn-primary">确定</button>
                    </div>
                </div>
            </form>

            <!--end::Form-->
        </div>

        <!--end::Portlet-->

    </div>
{% endblock %}

{% block custom_javascripts %}

    <script src="{{ asset('assets/summernote-0.8.9-dist/dist/summernote.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/summernote-0.8.9-dist/dist/lang/summernote-zh-CN.js') }}"
            type="text/javascript"></script>
    <script src="{{ asset('assets/inchTimeJs/content.js') }}" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            //编辑器
            $('#summernote').summernote({
                lang: 'zh-CN',
                height: 300,
                callbacks: {
                    onImageUpload: function (files, editor, welEditable) {
                        for (var i = files.length - 1; i >= 0; i--) {
                            sendFile("{{ path('file_upload') }}", files[i], this);
                        }
                    }
                }
            });

        });

    </script>
{% endblock %}